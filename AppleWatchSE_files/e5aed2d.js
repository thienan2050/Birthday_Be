(window.webpackJsonp=window.webpackJsonp||[]).push([[166],{1183:function(e,t,n){e.exports={}},1638:function(e,t,n){"use strict";n(1183)},2045:function(e,t,n){"use strict";n.r(t);n(15),n(33),n(60),n(64),n(46),n(9),n(36),n(47),n(48),n(22),n(23);var o=n(0),r=n(7),c=(n(8),n(229),n(62),n(91),n(82),n(26)),l=n(105),d=n(796);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={name:"BoxRegisterInfomation",props:{productName:{type:String,default:""},variants:{type:Array,default:function(){return[]}}},data:function(){return{sub_name:"",sub_phone:"",sub_email:"",sub_provice:"Hồ Chí Minh",hasSubscription:!1,product_name:"",sub_product_id:0,sub_product_sku:"",sub_product_color:"",sub_product_attribute_set_id:0,isLoading:!1,isSuccess:!1,isShowModal:!1,total:0,currentPage:1,phoneSearch:"",customerList:[],modalRegisterShow:!1,stockStatus:d}},computed:h(h(h(h({},Object(c.e)("province",["stockAvailable","listProvince","province"])),Object(c.e)("product",["productId","selectColorId","productData"])),Object(c.e)("login",["user"])),{},{productSelect:function(){var e=this;if(!this.variants.length||!this.selectColorId)return null;var t=this.variants.find((function(t){var n;return(null===(n=t.general)||void 0===n?void 0:n.product_id)===e.selectColorId}));return t||null},hotlineNumber:function(){return 7===this.$cookies.get("regionId")?"1800.2097":"1800.2044"},customerListFilter:function(){var e=this;return this.phoneSearch?this.customerList.filter((function(t){return t.customer.phone.includes(e.phoneSearch)})):this.customerList}}),watch:{currentPage:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getRegisterData();case 2:case"end":return t.stop()}}),t)})))()},phoneSearch:function(){this.customerListFilter()},sub_name:function(e){this.sub_name=this.capitalizeFirstCharacter(e)},province:function(){var e;this.sub_provice=null===(e=this.province)||void 0===e?void 0:e.name}},mounted:function(){var e;this.sub_provice=null===(e=this.province)||void 0===e?void 0:e.name,this.getRegisterData()},methods:h(h(h({customRegex:l.l,capitalizeFirstCharacter:l.d},Object(c.b)("brevo",["pushDataToBrevo"])),Object(c.b)("subscription",["sentSubscription"])),{},{pushSubToGA:function(title,e,t,n,o){var r=window.dataLayer||[],c=this.$cookies.get("required_login")||!1;r.push({event:e,isRequiredLogin:c,ecommerce:{currency:"VND",items:[{item_name:title}]},user_data:{email_address:o,phone_number:t,address:{first_name:n,last_name:"",city:"",region:"",district:"",ward:"",postal_code:"",country:""},form_key:"",form_name:"",form_vs:"",cf:""},eventModel:{value:0}}),console.log("DataLayer:"),console.log(r)},handleSubmitForm:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isLoading=!0,null!==(n=e.user)&&void 0!==n&&n.loggedIn&&(e.sub_name=e.user.name,e.sub_phone=e.user.phone||"",e.sub_email=e.user.email||""),e.sub_product_sku=(null===(o=e.productSelect)||void 0===o||null===(o=o.general)||void 0===o?void 0:o.sku)||"_",e.sub_product_color=(null===(r=e.productSelect)||void 0===r||null===(r=r.general)||void 0===r?void 0:r.attributes.color)||"_",e.sub_name.length>=1){t.next=9;break}return e.$alertMessage({message:"Vui lòng kiểm tra lại Họ Tên",icon:"CircleExclamation",type:"error"}),e.isLoading=!1,t.abrupt("return");case 9:if(e.customRegex(e.sub_phone,"phone")){t.next=14;break}return e.$alertMessage({message:"Vui lòng kiểm tra lại Số Điện Thoại",icon:"CircleExclamation",type:"error"}),e.isLoading=!1,t.abrupt("return");case 14:if(!e.hasSubscription||e.sub_email){t.next=17;break}return e.$alertMessage({message:"Vui lòng nhập email để nhận bản tin khuyến mãi",icon:"CircleExclamation",type:"error"}),t.abrupt("return",!1);case 17:if(e.customRegex(e.sub_email,"email")){t.next=22;break}return e.$alertMessage({message:"Vui lòng kiểm tra lại Email",icon:"CircleExclamation",type:"error"}),e.isLoading=!1,t.abrupt("return",null);case 22:return t.next=24,e.SubmitForm();case 24:e.isLoading=!1;case 25:case"end":return t.stop()}}),t)})))()},SubmitForm:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log('{"stock_status": '.concat((null===(n=e.productData)||void 0===n||null===(n=n.filterable)||void 0===n?void 0:n.stock_available_id)===d.SUBSCRIPTION?"subscribed":"out_of_stock","}")),r=window.location.origin+window.location.pathname,t.next=4,e.sentSubscription({productId:e.productId,productSku:e.sub_product_sku,productColor:e.sub_product_color,province:e.sub_provice,phone:e.sub_phone,name:e.sub_name,email:e.sub_email,type:"cellphones",fullPath:r,optIn:e.hasSubscription?"1":"0",showPopup:!1,embebData:'{"stock_status": "'.concat((null===(o=e.productData)||void 0===o||null===(o=o.filterable)||void 0===o?void 0:o.stock_available_id)===d.SUBSCRIPTION?"subscribed":"out_of_stock",'"}')});case 4:t.sent&&(e.pushSubToGA(e.productName,"dang_ky_nhan_thong_tin",e.sub_phone,e.sub_name,e.sub_email),e.pushSubEventToGA(e.productName,e.sub_email,e.sub_phone,e.sub_name)),e.isSuccess=!0,e.isLoading=!1,e.toggleModalRegister(!0);case 9:case"end":return t.stop()}}),t)})))()},getRegisterData:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={method:"get",url:"".concat("https://customer.cps.onl/","subscriptions-api/product?id=").concat(e.productId,"&type=cellphones&page=").concat(e.currentPage),headers:{Accept:"application/json",Authorization:"Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiIxMSIsImp0aSI6IjU5NDIwNWY5NTk3NzNlZGMyMjkyNTM2MWY0YzZjYTNhYjJkY2M4NWM3ZDQyZTAxYTdiOGI3ODJmNzRiMTNlYzBiMmRmOGI3ZjdjNzk2YmI1IiwiaWF0IjoxNjQ5MzE3MTQ2LjE4NjI1NiwibmJmIjoxNjQ5MzE3MTQ2LjE4NjI2MywiZXhwIjo0ODA0OTkwNzQ2LjE3NzI2NSwic3ViIjoiIiwic2NvcGVzIjpbInN1YnNjcmlwdGlvbl9nZXQiLCJzdWJzY3JpcHRpb25fcG9zdCJdfQ.aDVTQselmQaZItNB9nWP77M5VR6qO78_NDeP2Dg9q9WJqdj6S7WpzdI8cA72Zy0E9yYLsURywffGaTh8QZ8UWhqdbvcpXAXX3Gc-7-UZfz7gkH6QloYSENCqQ2DsPmOxNjHBHa1j8hNLm_re_GBMSZHbJMzdRJSjeJdRZ3gShAjw2A8VNmhiCTGes34BUawPaivi2BJiEQB_y1nQ2JPxOu5kpJ5UlL0KHkDFMT2q7_BVhgiZtwDU2dHqDzMuWOIkMkVopgvAge1YAnultmAnO-3ONe9hyqZqyvkClevkA_tV2LXVYkdUxyKSDCEDLeh7zS3OAdAmfuu8Xgs0gjlz_w1hchpJSWp6O6j7hxm5B0S76t4yMSLANwOJmVhweXugV9wTWhXCT1opya4J_VCf_tomABmMWeqnr3qkzzpxeYXCBLOXrbKiqjA4D8Gm0Z3NV54PPIdk4prSYNZXOan0xYRR1h3iIvt_mtEBJwvl0wlZ80MbudWQExWUglNRG5mN3yLaMygOs3SZSS1WpSycB94Kcsfpb5V2hWFm5erO6Fdc7oRf3aXLFrQnFcyOooUaL0KJq85HPOuK1SIMGah443QiYT7zzQ06Mb81gKwjbeU3IMpmKaZI9ilZZlJBYsrOTUeEWvdBK5i7GpyZcNA-77Lhxumi1XVFEznQBtL3Jcg"}},t.prev=1,t.next=4,e.$axios(n);case 4:200===(o=t.sent).status&&(e.total=o.data.meta.pagination.total,e.customerList=o.data.data,e.currentPage=o.data.meta.pagination.current_page),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()},handleOpenModal:function(e){this.isShowModal=e,document.querySelector(".box-detail-product__box-center").style["z-index"]=e?12:10},toggleModalRegister:function(e){this.modalRegisterShow=e,document.querySelector(".box-detail-product__box-center").style["z-index"]=e?12:10},pushSubEventToGA:function(title,e,t,n){console.time("pushSubEventToGA"),setTimeout((function(){var o=window.dataLayer||[];o.push({user_data:{email_address:e,phone_number:t,address:{first_name:n,last_name:"",city:"",region:"",district:"",ward:"",postal_code:"",country:""},form_key:"",form_name:"RegisterProduct",form_vs:"",cf:"cf_51=".concat(title)},event:"generate_lead",eventAction:"generate_lead",cdpData:{properties:{gender:"",birthYear:""}},eventModel:{value:0}}),console.log("DataLayer:"),console.log(o)}),500),console.timeEnd("pushSubEventToGA")}})},_=(n(1638),n(74)),component=Object(_.a)(v,(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:!e.stockAvailable,expression:"!stockAvailable"}]},[e.isSuccess?e.isSuccess?t("div",{staticClass:"modal",class:!e.modalRegisterShow||"is-active",attrs:{id:"modalSuccessRegister"}},[t("div",{staticClass:"modal-background",on:{click:function(t){return e.toggleModalRegister(!1)}}}),e._v(" "),t("div",{staticClass:"modal-content modal-login"},[t("nuxt-img",{staticClass:"cps-ok-ant",attrs:{provider:"CPS_IMG_PROVIDER",format:"webp",height:"120",src:"https://cdn2.cellphones.com.vn/x/media/wysiwyg/OK.gif",alt:"cps-smember-icon"}}),e._v(" "),t("div",{staticClass:"title is-flex is-justify-content-center is-align-items-center"},[e._v("\n        Đăng ký nhận tin thành công!\n      ")]),e._v(" "),e._m(1),e._v(" "),t("div",{staticClass:"group-continue-btn is-flex is-justify-content-space-between mt-3"},[t("div",{staticClass:"continue-btn modal__button",on:{click:function(t){return e.toggleModalRegister(!1)}}},[e._v("\n          Tiếp tục mua sắm\n        ")])]),e._v(" "),t("button",{staticClass:"modal-close is-medium modal__button",attrs:{"aria-label":"close"},on:{click:function(t){return e.toggleModalRegister(!1)}}})],1)]):e._e():t("div",{staticClass:"box-register-product p-2 my-2 has-text-centered"},[t("p",{staticClass:"has-text-weight-semibold"},[e._v("ĐĂNG KÝ NHẬN THÔNG TIN KHI CÓ HÀNG")]),e._v(" "),t("form",{staticClass:"box-register-product-form",on:{submit:function(t){return t.preventDefault(),e.handleSubmitForm.apply(null,arguments)}}},[e.user.loggedIn?e._e():[t("input",{directives:[{name:"model",rawName:"v-model",value:e.sub_name,expression:"sub_name"}],staticClass:"input my-1",attrs:{type:"text",placeholder:"Họ tên (*bắt buộc)"},domProps:{value:e.sub_name},on:{input:function(t){t.target.composing||(e.sub_name=t.target.value)}}}),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.sub_phone,expression:"sub_phone"}],staticClass:"input my-1",attrs:{id:"inputPhone",type:"text",placeholder:"Số điện thoại (bắt buộc)",maxlength:"10"},domProps:{value:e.sub_phone},on:{input:function(t){t.target.composing||(e.sub_phone=t.target.value)}}}),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.sub_email,expression:"sub_email"}],staticClass:"input my-1",attrs:{id:"inputEmail",type:"text",placeholder:"Địa chỉ email (để nhận phản hồi qua email"},domProps:{value:e.sub_email},on:{input:function(t){t.target.composing||(e.sub_email=t.target.value)}}}),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.sub_provice,expression:"sub_provice"}],staticClass:"input my-1",attrs:{id:"inputProvince",placeholder:"Địa chỉ email (để nhận phản hồi qua email"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.sub_provice=t.target.multiple?n:n[0]}}},e._l(e.listProvince,(function(n,o){return t("option",{key:o,domProps:{value:(null==n?void 0:n.name)||""}},[e._v(e._s(n.name))])})),0)],e._v(" "),t("div",{staticClass:"option is-flex"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.hasSubscription,expression:"hasSubscription"}],staticClass:"option__checkbox",attrs:{id:"subscription",type:"checkbox"},domProps:{checked:Array.isArray(e.hasSubscription)?e._i(e.hasSubscription,null)>-1:e.hasSubscription},on:{change:function(t){var n=e.hasSubscription,o=t.target,r=!!o.checked;if(Array.isArray(n)){var c=e._i(n,null);o.checked?c<0&&(e.hasSubscription=n.concat([null])):c>-1&&(e.hasSubscription=n.slice(0,c).concat(n.slice(c+1)))}else e.hasSubscription=r}}}),e._v(" "),t("label",{staticClass:"checkbox__text",attrs:{for:"subscription"}},[e._v("\n          Đăng ký nhận bản tin khuyến mãi qua email\n        ")])]),e._v(" "),t("button",{staticClass:"button form__button my-2 has-text-white has-text-weight-bold",class:e.isLoading?"is-loading":"",attrs:{type:"submit"}},[e._v("\n        ĐĂNG KÝ NHẬN THÔNG TIN\n      ")])],2),e._v(" "),e.total>0?t("div",{staticClass:"register-customer-count"},[t("p",[e._v("Có "),t("strong",[e._v(e._s(e.total))]),e._v(" khách hàng đã đăng ký. "),t("span",{staticClass:"button__view-list-customer",on:{click:function(t){return e.handleOpenModal(!0)}}},[e._v("Xem danh sách")])]),e._v(" "),t("div",{staticClass:"modal",class:e.isShowModal&&"is-active"},[t("div",{staticClass:"modal-background",on:{click:function(t){return e.handleOpenModal(!1)}}}),e._v(" "),t("div",{staticClass:"modal-card"},[t("header",{staticClass:"modal-card-head"},[t("p",{staticClass:"modal-card-title"},[e._v("KHÁCH HÀNG ĐĂNG KÝ NHẬN THÔNG TIN")]),e._v(" "),t("button",{staticClass:"delete modal__button",attrs:{"aria-label":"close"},on:{click:function(t){return e.handleOpenModal(!1)}}})]),e._v(" "),t("section",{staticClass:"modal-card-body"},[t("div",{staticClass:"modal-search-phone is-flex is-justify-content-space-between"},[t("p",{staticClass:"has-text-left"},[e._v("Có "),t("strong",[e._v(e._s(e.total))]),e._v(" khách đăng ký")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneSearch,expression:"phoneSearch"}],staticClass:"p-1",attrs:{placeholder:"Nhập 3 số cuối điện thoại để tìm kiếm",maxlength:"3"},domProps:{value:e.phoneSearch},on:{input:function(t){t.target.composing||(e.phoneSearch=t.target.value)}}})]),e._v(" "),t("div",{staticClass:"modal-search-result mt-2"},[t("table",{staticClass:"table"},[t("caption",{attrs:{hidden:""}},[e._v("Đăng ký nhận tin")]),e._v(" "),e._m(0),e._v(" "),e.customerList.length>0?t("tbody",[e._l(e.customerListFilter,(function(n,o){return[t("tr",{key:o},[t("td",{staticClass:"has-text-left"},[e._v(e._s(n.customer.fullname))]),e._v(" "),t("td",[e._v(e._s(n.customer.phone))]),e._v(" "),t("td",[e._v(e._s(n.created_at))])])]}))],2):e._e()])])]),e._v(" "),e.total>10?t("footer",{staticClass:"modal-card-foot is-flex is-justify-content-center is-align-items-center"},[e.currentPage-1>0?t("RenderHtml",{staticClass:"button-icon is-flex is-align-items-center is-justify-content-center",attrs:{html:e.$icons().ChevronLeft},on:{click:function(t){e.currentPage}}}):e._e(),e._v(" "),t("span",[e._v(e._s(e.currentPage))]),e._v(" "),10*(e.currentPage+1)<=e.total?t("RenderHtml",{staticClass:"button-icon is-flex is-align-items-center is-justify-content-center",attrs:{html:e.$icons().ChevronRight},on:{click:function(t){e.currentPage}}}):e._e()],1):e._e()])])]):e._e()])])}),[function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("Khách hàng")]),e._v(" "),t("th",[e._v("Số điện thoại")]),e._v(" "),t("th",[e._v("Thời gian")])])])},function(){var e=this._self._c;return e("div",{staticClass:"text"},[e("p",[this._v("Cảm ơn bạn đã đăng ký nhận tin về hàng sản phẩm, CellphoneS sẽ liên hệ lại sớm nhất ngay khi có hàng")])])}],!1,null,"06ea10ba",null);t.default=component.exports}}]);