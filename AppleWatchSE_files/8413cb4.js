(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{1982:function(e,t,r){"use strict";r.r(t);r(46),r(36),r(47),r(48);var o=r(0),c=r(7),n=(r(8),r(33),r(60),r(169),r(22),r(9),r(23),r(82),r(26)),l=r(105);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){Object(c.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var h={name:"SelectProductCompare",components:{},props:{productData:{type:Object,default:function(){return{}}},modalType:{type:Number,default:0},productIds:{type:Array,default:function(){return[]}}},data:function(){return{inputSearch:"",searching:!1,cpsMain:"https://cellphones.com.vn/",selectedBrand:"all",filter:{},similarId:null,page:1}},computed:m(m(m({},Object(n.e)("pdp-compare",["isShowSelectProductModal","isShowModal","storageCompareData","storageCompareDataValues","searchProducts","totalSearchProducts"])),Object(n.e)("compare",["compareProducts","loadedProducts"])),Object(n.e)("product",["filterData"])),watch:{inputSearch:function(){var e=this;clearTimeout(this.timeOut),this.loading=!0,this.timeOut=setTimeout((function(){var t=e.productIds;0===t.length&&(t=Object.keys(e.storageCompareData)),e.inputSearch.length>=3?(e.page=1,e.searchProductToCompare({categoryIds:[e.similarId],keySearch:e.inputSearch,existCompareProductIds:t}),e.searchResults&&(e.loading=!1)):0===e.inputSearch.length&&(e.page=1,e.searchProductToCompare({categoryIds:[e.similarId],keySearch:"",existCompareProductIds:t}),e.searchResults&&(e.loading=!1))}),500)},isShowModal:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isShowModal){t.next=6;break}return e.similarId=e.getSimilarIds(),0===(r=e.productIds).length&&(r=Object.keys(e.storageCompareData)),t.next=6,e.searchProductToCompare({categoryIds:[e.similarId],keySearch:"",existCompareProductIds:r});case 6:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.similarId=e.getSimilarIds(),0===(r=e.productIds).length&&(r=Object.keys(e.storageCompareData)),!r.length){t.next=6;break}return t.next=6,e.searchProductToCompare({categoryIds:[e.similarId],keySearch:"",existCompareProductIds:r});case 6:case"end":return t.stop()}}),t)})))()},methods:m(m(m(m(m({formatMoney:l.o},Object(n.b)("pdp-compare",["searchProductToCompare"])),Object(n.b)("compare",["newCompareUrl"])),Object(n.d)("pdp-compare",["showSelectProductModal","pushToStorageData","showCompareModal"])),Object(n.b)("product",["getFilterByCateId"])),{},{getSimilarIds:function(){var e,t,r,o=null===(e=this.productData.general)||void 0===e||null===(e=e.categories)||void 0===e?void 0:e.filter((function(e){return""!==e.similar}));(null!=o&&o.length&&(t=o.reduce((function(e,t){return e.level>t.level?e:t})).similar),t)||(t=null===(r=this.productData.general.categories)||void 0===r?void 0:r.filter((function(e){return 2===e.level})).map((function(e){return e.categoryId})).shift());return t},focusOutSearchInput:function(){var e=this;setTimeout((function(){e.searching=!1}),500)},selectProduct:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var o,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=e.general.categories.map((function(e){return e.categoryId})),!(0!==t.modalType&&t.compareProducts.length>0)){r.next=4;break}return r.next=4,t.compareProducts.forEach((function(e){t.pushToStorageData({id:e.general.product_id,data:{name:e.general.name,thumbnail:e.filterable.thumbnail,id:e.general.product_id,category_ids:e.general.categories.map((function(e){return e.categoryId})),path:e.general.attributes.url_key}})}));case 4:t.pushToStorageData({id:e.general.product_id,data:{name:e.general.name,thumbnail:e.filterable.thumbnail,id:e.general.product_id,category_ids:o,path:e.general.attributes.url_key}}),localStorage.setItem("compare_products",JSON.stringify(t.storageCompareData)),t.showSelectProductModal(),0===t.modalType?t.showCompareModal():(c="/so-sanh/"+t.$route.params.sosanh+"-vs-"+e.general.attributes.url_key,window.location.href=c);case 8:case"end":return r.stop()}}),r)})))()},loadMoreProducts:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.page+=1,t.next=3,e.searchProductToCompare({categoryIds:[e.similarId],keySearch:e.inputSearch,price:e.productData.filterable.price,isLoadMore:!0,page:e.page});case 3:case"end":return t.stop()}}),t)})))()}})},f=r(74),component=Object(f.a)(h,(function(){var e,t=this,r=t._self._c;return null!==(e=t.productData)&&void 0!==e&&e.general?r("div",{staticClass:"modal",class:t.isShowSelectProductModal&&"is-active",attrs:{id:"search-to-compare"}},[r("div",{staticClass:"modal-background"}),t._v(" "),r("div",{staticClass:"modal-card"},[r("header",{staticClass:"modal-card-head"},[r("p",{staticClass:"modal-card-title"},[t._v("Tìm sản phẩm để so sánh")]),t._v(" "),r("button",{staticClass:"delete",attrs:{"aria-label":"close"},on:{click:function(e){t.showSelectProductModal(),t.showCompareModal()}}})]),t._v(" "),r("section",{staticClass:"modal-card-body"},[r("div",{staticClass:"form-group box-search"},[r("RenderHtml",{staticClass:"icon-search",attrs:{html:t.$icons().Search}}),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.inputSearch,expression:"inputSearch"}],staticClass:"input box-search__input button__compare-input",attrs:{type:"text",placeholder:"Nhập tên sản phẩm muốn so sánh",autocomplete:"off"},domProps:{value:t.inputSearch},on:{focusout:function(e){return t.focusOutSearchInput()},click:function(e){t.searching=!0},input:function(e){e.target.composing||(t.inputSearch=e.target.value)}}})],1),t._v(" "),r("div",[t.searchProducts.length>0?r("div",{staticClass:"compare-search-product-list product-list-filter is-flex is-flex-wrap-wrap mt-4"},t._l(t.searchProducts,(function(e,o){var c,n,l;return r("div",{key:o,staticClass:"product-item product-info-container p-3",class:"item-".concat(null===(c=e.general)||void 0===c?void 0:c.product_id)},[r("div",{staticClass:"product-info"},[r("a",[r("div",{staticClass:"product__image has-text-centered"},[r("nuxt-img",{attrs:{provider:"CPS_IMG_PROVIDER",format:"webp",width:"160",height:"160",alt:null===(n=e.general)||void 0===n?void 0:n.name,src:"https://cdn2.cellphones.com.vn/500x500/media/catalog/product/".concat(e.filterable.thumbnail),loading:"lazy"}})],1),t._v(" "),r("a",{staticClass:"product-name"},[t._v(t._s(null===(l=e.general)||void 0===l?void 0:l.name))]),t._v(" "),r("p",{staticClass:"price"},[t._v("Giá niêm yết: "),r("span",[t._v(t._s(t.formatMoney(e.filterable.price)))])]),t._v(" "),r("p",{staticClass:"sale-price"},[e.filterable.special_price?r("span",[t._v("Giá khuyến mãi:\n                    "),r("span",[t._v(t._s(t.formatMoney(e.filterable.special_price)))])]):t._e()]),t._v(" "),r("a",{staticClass:"select-to-compare has-text-centered mt-1",on:{click:function(r){return t.selectProduct(e)}}},[t._v("+ Chọn để so sánh")])])])])})),0):t._e(),t._v(" "),t.totalSearchProducts>t.searchProducts.length&&t.searchProducts.length>0?r("div",{staticClass:"compare-search-loadmore has-text-centered mt-3"},[r("a",{on:{click:function(e){return t.loadMoreProducts()}}},[t._v("Xem thêm")])]):0===t.searchProducts.length?r("div",[r("p",[t._v("Không tìm được sản phẩm phù hợp")])]):t._e()])])])]):t._e()}),[],!1,null,null,null);t.default=component.exports}}]);